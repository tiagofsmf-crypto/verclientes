<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gest√£o de Clientes - Gaia Phone</title>
<style>
body {
font-family: Arial, sans-serif;
margin: 20px;
background-color: #0a0a0a;
color: #f5f5f5;
}
h1 {
text-align: center;
color: #00ffff;
text-shadow: 0 0 8px #00ffff80;
}
.logo {
display: block;
margin: 0 auto 20px auto;
width: 150px;
}
.form-container, .list-container, .print-container {
background: #1a1a1a;
padding: 20px;
margin-bottom: 20px;
border-radius: 10px;
box-shadow: 0 2px 8px rgba(0,255,255,0.2);
}
input, button {
display: block;
margin: 10px 0;
padding: 10px;
width: 100%;
font-size: 16px;
border-radius: 5px;
border: 1px solid #333;
background: #111;
color: #fff;
}
button {
background: linear-gradient(90deg, #00bcd4, #008cff);
color: white;
border: none;
cursor: pointer;
transition: 0.3s;
}
button:hover {
transform: scale(1.05);
}
table {
width: 100%;
border-collapse: collapse;
margin-top: 10px;
}
th, td {
border: 1px solid #333;
padding: 10px;
text-align: left;
}
@media print {
body * { visibility: hidden; }
.print-container, .print-container * { visibility: visible; }
.print-container {
position: absolute;
left: 0;
top: 0;
width: 100%;
}
}
</style>
</head>
<body>

<h1>üì± Gaia Phone - Gest√£o de Clientes</h1>
<img src="logo.png" alt="Logo Gaia Phone" class="logo">

<div class="form-container">
<h2>Adicionar Cliente</h2>
<input type="text" id="nome" placeholder="Nome">
<input type="text" id="telefone" placeholder="Telefone">
<input type="text" id="imei" placeholder="IMEI do Telem√≥vel">
<input type="text" id="morada" placeholder="Morada">
<input type="text" id="marca" placeholder="Marca">
<input type="text" id="modelo" placeholder="Modelo">
<input type="text" id="avaria" placeholder="Avaria">
<button onclick="adicionarCliente()">Adicionar Cliente</button>
</div>

<div class="list-container">
<h2>Procurar Cliente</h2>
<input type="text" id="search" placeholder="Procurar por telefone ou IMEI" oninput="procurarCliente()">
<select id="clienteSelect" onchange="mostrarCliente()">
<option value="">-- Selecionar Cliente --</option>
</select>
</div>

<div class="print-container" id="printContainer" style="display:none;">
<h2>Ficha do Cliente</h2>
<img src="logo.png" alt="Logo Gaia Phone" class="logo">
<p><strong>Nome:</strong> <span id="pNome"></span></p>
<p><strong>Telefone:</strong> <span id="pTelefone"></span></p>
<p><strong>IMEI:</strong> <span id="pImei"></span></p>
<p><strong>Morada:</strong> <span id="pMorada"></span></p>
<p><strong>Marca:</strong> <span id="pMarca"></span></p>
<p><strong>Modelo:</strong> <span id="pModelo"></span></p>
<p><strong>Avaria:</strong> <span id="pAvaria"></span></p>
<p><strong>Data de Registo:</strong> <span id="pData"></span></p>
<button onclick="window.print()">üñ®Ô∏è Imprimir</button>
</div>

<script>
const BIN_ID = "68f9f8dbae596e708f25f839";
const MASTER_KEY = "$2a$10$dG2ThExIwcpAMH8TWK7.nutw7YbLh999/nA8ZIHUebC2Bgxg.kxbC";
const API_URL = `https://api.jsonbin.io/v3/b/${BIN_ID}`;

let clientes = [];

// üîπ Carregar dados do JSONBin
async function carregarClientes() {
try {
const res = await fetch(API_URL + "/latest", {
headers: { "X-Master-Key": MASTER_KEY }
});
const data = await res.json();
clientes = data.record || [];
atualizarLista();
} catch (err) {
console.error("Erro ao carregar clientes:", err);
}
}

// üîπ Atualizar lista no seletor
function atualizarLista() {
const select = document.getElementById("clienteSelect");
select.innerHTML = '<option value="">-- Selecionar Cliente --</option>';
clientes.forEach((c, i) => {
const option = document.createElement("option");
option.value = i;
option.text = `${c.nome} (${c.telefone})`;
select.add(option);
});
}

// üîπ Adicionar cliente
async function adicionarCliente() {
const nome = document.getElementById("nome").value;
const telefone = document.getElementById("telefone").value;
const imei = document.getElementById("imei").value;
const morada = document.getElementById("morada").value;
const marca = document.getElementById("marca").value;
const modelo = document.getElementById("modelo").value;
const avaria = document.getElementById("avaria").value;
const data = new Date().toLocaleDateString();

if (!nome || !telefone) {
alert("Preencha pelo menos o nome e telefone!");
return;
}

clientes.push({ nome, telefone, imei, morada, marca, modelo, avaria, data });
atualizarLista();

try {
await fetch(API_URL, {
method: "PUT",
headers: {
"Content-Type": "application/json",
"X-Master-Key": MASTER_KEY
},
body: JSON.stringify(clientes)
});
alert("‚úÖ Cliente adicionado com sucesso!");
} catch (err) {
console.error("Erro ao gravar:", err);
}
}

// üîπ Mostrar cliente
function mostrarCliente() {
const index = document.getElementById("clienteSelect").value;
if (index === "") return;

const c = clientes[index];
document.getElementById("pNome").innerText = c.nome;
document.getElementById("pTelefone").innerText = c.telefone;
document.getElementById("pImei").innerText = c.imei;
document.getElementById("pMorada").innerText = c.morada;
document.getElementById("pMarca").innerText = c.marca;
document.getElementById("pModelo").innerText = c.modelo;
document.getElementById("pAvaria").innerText = c.avaria;
document.getElementById("pData").innerText = c.data;

document.getElementById("printContainer").style.display = "block";
}

// üîπ Procurar cliente
function procurarCliente() {
const termo = document.getElementById("search").value.toLowerCase();
const select = document.getElementById("clienteSelect");
select.innerHTML = '<option value="">-- Selecionar Cliente --</option>';

clientes.forEach((c, i) => {
if (c.telefone.toLowerCase().includes(termo) || c.imei.toLowerCase().includes(termo)) {
const option = document.createElement("option");
option.value = i;
option.text = `${c.nome} (${c.telefone})`;
select.add(option);
}
});
}

// Iniciar
carregarClientes();
</script>

</body>
</html>
