<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gaia Phone - Gestão de Clientes</title>
<style>
* { margin:0; padding:0; box-sizing:border-box; font-family: Arial, sans-serif; }
body { background:#f5f5f5; }
#loginContainer { max-width:400px; margin:100px auto; background:#fff; padding:30px; border-radius:10px; box-shadow:0 4px 10px rgba(0,0,0,0.15); text-align:center; }
#loginContainer img { width:80px; margin-bottom:20px; }
#loginContainer input, #loginContainer button { width:80%; margin:10px auto; padding:10px; font-size:16px; border-radius:5px; border:1px solid #ccc; }
#loginContainer button { background:#001f3f; color:white; border:none; cursor:pointer; }
#loginContainer button:hover { background:#001533; }

#app { display:none; }
header { background:#001f3f; color:white; text-align:center; padding:20px 0; }
header img { width:80px; display:block; margin:0 auto 10px; }
header h1 { margin-top:5px; font-size:24px; }

.container { max-width:900px; margin:20px auto; background:white; padding:20px; border-radius:8px; box-shadow:0 2px 5px rgba(0,0,0,0.1); }
input, select, button { display:block; margin:10px 0; padding:10px; width:100%; font-size:16px; border-radius:5px; border:1px solid #ccc; }
button { background:#001f3f; color:white; border:none; cursor:pointer; }
button:hover { background:#001533; }

.print-container { display:none; background:white; padding:20px; border-radius:10px; max-width:600px; margin:20px auto; text-align:center; }
.print-container img { width:80px; margin-bottom:10px; }
.print-container hr { margin:10px 0; }
.print-container select { width:200px; margin:0 auto; display:block; }

@media print {
body * { visibility:hidden; }
.print-container, .print-container * { visibility:visible; }
.print-container { position:absolute; left:0; top:0; width:100%; margin:0; padding:20px; }
}
</style>
</head>
<body>

<div id="loginContainer">
<img src="logo.png" alt="Logo Gaia Phone">
<h2>Login</h2>
<input type="password" id="password" placeholder="Senha">
<button onclick="login()">Entrar</button>
</div>

<div id="app">
<header>
<img src="logo.png" alt="Logo Gaia Phone">
<h1>Gaia Phone - Gestão de Clientes</h1>
</header>

<div class="container">
<h2>Adicionar Cliente</h2>
<input type="text" id="nome" placeholder="Nome">
<input type="text" id="telefone" placeholder="Telefone">
<input type="text" id="imei" placeholder="IMEI">
<input type="text" id="marca" placeholder="Marca do Equipamento">
<input type="text" id="modelo" placeholder="Modelo do Equipamento">
<input type="text" id="avaria" placeholder="Avaria">
<button onclick="adicionarCliente()">Adicionar Cliente</button>
<button id="btnSalvar">Guardar Cliente</button>
</div>

<div class="container">
<h2>Clientes</h2>
<input type="text" id="pesquisa" placeholder="Procurar pelo Telefone ou IMEI" oninput="filtrarClientes()">
<select id="clienteSelect" onchange="mostrarCliente()">
<option value="">-- Selecionar Cliente --</option>
</select>
<button onclick="editarCliente()">Editar Cliente</button>
</div>

<div class="print-container" id="printContainer">
<img src="logo.png" alt="Logo Gaia Phone">
<h2>Reparações de Telemóveis</h2>
<p>Rua José Rocha, 189 A, 4430-123 V.N. Gaia</p>
<p>222 441 808 | 931 965 105</p>
<p>gaiaphone@gmail.com</p>
<hr>
<p><strong>Nome:</strong> <span id="pNome"></span></p>
<p><strong>Telefone:</strong> <span id="pTelefone"></span></p>
<p><strong>IMEI:</strong> <span id="pIMEI"></span></p>
<p><strong>Marca:</strong> <span id="pMarca"></span></p>
<p><strong>Modelo:</strong> <span id="pModelo"></span></p>
<p><strong>Avaria:</strong> <span id="pAvaria"></span></p>
<p><strong>Data de Registo:</strong> <span id="pData"></span></p>
<p><strong>Status:</strong>
<select id="pStatus">
<option>Não Reparado</option>
<option>Reparado</option>
</select>
</p>
</div>

<button onclick="imprimirFicha()">Imprimir</button>

<script>
function login(){
const pass=document.getElementById('password').value;
if(pass==='roque'){
document.getElementById('loginContainer').style.display='none';
document.getElementById('app').style.display='block';
carregarClientes();
} else { alert('Senha incorreta!'); }
}
document.getElementById('password').addEventListener("keyup", function(event){ if(event.key==="Enter") login(); });

let clientes=[];
function carregarClientes(){
clientes=JSON.parse(localStorage.getItem('clientes'))||[];
atualizarSelect();
}

function adicionarCliente(){
const nome=document.getElementById('nome').value;
const telefone=document.getElementById('telefone').value;
const imei=document.getElementById('imei').value;
const marca=document.getElementById('marca').value;
const modelo=document.getElementById('modelo').value;
const avaria=document.getElementById('avaria').value;
const data=new Date().toLocaleDateString();
if(!nome){ alert('Preencha o nome do cliente!'); return; }
const cliente={nome,telefone,imei,marca,modelo,avaria,data,status:"Não Reparado"};
clientes.push(cliente);
localStorage.setItem('clientes',JSON.stringify(clientes));
atualizarSelect(); limparCampos();
}

function editarCliente(){
const index=document.getElementById('clienteSelect').value;
if(index===""){ alert('Selecione um cliente'); return; }
const c=clientes[index];
document.getElementById('nome').value=c.nome;
document.getElementById('telefone').value=c.telefone;
document.getElementById('imei').value=c.imei;
document.getElementById('marca').value=c.marca;
document.getElementById('modelo').value=c.modelo;
document.getElementById('avaria').value=c.avaria;
document.getElementById('nome').scrollIntoView({behavior:'smooth'});

document.getElementById('btnSalvar').onclick=function(){
c.nome=document.getElementById('nome').value;
c.telefone=document.getElementById('telefone').value;
c.imei=document.getElementById('imei').value;
c.marca=document.getElementById('marca').value;
c.modelo=document.getElementById('modelo').value;
c.avaria=document.getElementById('avaria').value;
localStorage.setItem('clientes',JSON.stringify(clientes));
atualizarSelect(); limparCampos();
alert("Cliente atualizado!");
};
}

function atualizarSelect(){
const select=document.getElementById('clienteSelect');
select.innerHTML='<option value="">-- Selecionar Cliente --</option>';
clientes.forEach((c,i)=>{
const option=document.createElement('option');
option.value=i;
option.text=`${c.nome} | ${c.telefone} | ${c.imei}`;
select.add(option);
});
}

function limparCampos(){['nome','telefone','imei','marca','modelo','avaria'].forEach(id=>document.getElementById(id).value='');}

function mostrarCliente(){
const index=document.getElementById('clienteSelect').value;
if(index==="") return;
const c=clientes[index];
document.getElementById('pNome').innerText=c.nome;
document.getElementById('pTelefone').innerText=c.telefone;
document.getElementById('pIMEI').innerText=c.imei;
document.getElementById('pMarca').innerText=c.marca;
document.getElementById('pModelo').innerText=c.modelo;
document.getElementById('pAvaria').innerText=c.avaria;
document.getElementById('pData').innerText=c.data;
document.getElementById('pStatus').value=c.status;
document.getElementById('printContainer').style.display='block';
}

function filtrarClientes(){
const filtro=document.getElementById('pesquisa').value.toLowerCase();
const select=document.getElementById('clienteSelect');
select.innerHTML='<option value="">-- Selecionar Cliente --</option>';
clientes.forEach((c,i)=>{
if(c.telefone.toLowerCase().includes(filtro)||c.imei.toLowerCase().includes(filtro)){
const option=document.createElement('option');
option.value=i;
option.text=`${c.nome} | ${c.telefone} | ${c.imei}`;
select.add(option);
}
});
}

function imprimirFicha(){
// Salva o status selecionado antes de imprimir
const index=document.getElementById('clienteSelect').value;
if(index!==""){
clientes[index].status=document.getElementById('pStatus').value;
localStorage.setItem('clientes',JSON.stringify(clientes));
}
window.print();
}
</script>
</body>
</html>
